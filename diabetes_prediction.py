# -*- coding: utf-8 -*-
"""diabetes_prediction.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1Ls_JSl4hm3_me4PNGG27LQ_wqeYSqyLj
"""

import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns
import sklearn as sk
from sklearn.model_selection import train_test_split

df=pd.read_csv("/content/Training.csv")

df.head()

df.tail()

df.shape

df.info()

df.isnull().sum()

df.describe()

plt.figure(figsize=(12,6))
sns.heatmap(df.corr(),annot=True)

plt.figure(figsize=(12,6))
sns.countplot(x="Outcome",data=df)
plt.show()

plt.figure(figsize=(12,12))
for i,col in enumerate(["Pregnancies","Glucose","BloodPressure","SkinThickness","Insulin","BMI"]):
 plt.subplot(3,3,i+1)
 sns.boxplot(x=col,data=df)
 plt.show()

sns.pairplot(df,hue="Outcome" )

plt.figure(figsize=(12,12))
for i,col in enumerate(["Pregnancies","Glucose","BloodPressure","SkinThickness","Insulin"]):
 plt.subplot(3,3,i+1)
 sns.histplot(x=col,data=df,kde=True)
 plt.show()

from sklearn.preprocessing import StandardScaler
sc_X=StandardScaler()
X= pd.DataFrame(sc_X.fit_transform(df.drop(["Outcome"],axis=1),),columns=["Pregnancies","Glucose","BloodPressure","SkinThickness","Insulin","BMI","Age","DiabetesPedigreeFunction"])

X.head()

y=df["Outcome"]

from sklearn.model_selection import train_test_split
X_train,X_test,y_train,y_test=train_test_split(X,y,test_size=0.2)

from sklearn.neighbors import KNeighborsClassifier
test_scores=[]
train_scores=[]
for i in range(1,20):
  knn= KNeighborsClassifier(i)
  knn.fit(X_train,y_train)

  train_scores.append(knn.score(X_train,y_train))
  test_scores.append(knn.score(X_train,y_train))

max_train_score=max(train_scores)
train_scores_index=[i for i,v in enumerate(train_scores)if v== max_train_score]
print("max_train_score{} % and k={}".format(max_train_score*100,list(map(lambda X: X+1,train_scores_index))))

max_test_score=max(test_scores)
test_scores_index=[i for i,v in enumerate(test_scores)if v== max_test_score]
print("max_test_score{} % and k={}".format(max_test_score*100,list(map(lambda X: X+1,test_scores_index))))

knn=KNeighborsClassifier(13)
knn.fit(X_train,y_train)
knn.score(X_test,y_test)

from sklearn.metrics import confusion_matrix
y_pred=knn.predict(X_test)
confusion_matrix(y_test,y_pred)

from sklearn.metrics import classification_report
print(classification_report(y_test, y_pred))

